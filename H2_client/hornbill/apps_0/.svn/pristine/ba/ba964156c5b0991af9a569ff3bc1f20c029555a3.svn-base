<%
	/**
 	 * @fileoverview 会员权益－会员中心
     * @requires zepto
     * @author kehuang@meilishuo.com
     * @date 2015-06-23
     */
%>

<%#head.html%>
<%
	var userMaxLevel = 5;
	var curPageData = this.pageData || {};
	var curUserInfo = this.userInfo || {};
	var curUserData = this.userInfoData.data || {};
	var curUserBeautyData = this.percentData.data || {};
	var curUserName = curUserInfo.nickname || '';
	var curUserLevel = curUserData.grade || 0;
	var curUserUpdateLevel = (curUserLevel < 4) ? (curUserLevel + 1) : 4;
	var curUserBeauty = curUserBeautyData.score || 0;
	var curUserRemainBeauty = curUserBeautyData.remaind_score || 0;
	var tempUserPercent = curUserBeautyData.left_percent || 0;
	var curUserPercent = parseInt((curUserLevel +  tempUserPercent / 100) * 25) + '%';
%>

<div class="main">
	<div class="banner_wrap">
		<div class="user_box">
			<div class="user_info">
				<div class="name"><%= curUserName %>&nbsp;<span class="level<%= curUserLevel %>"></span></div>
				<%
					switch (curUserLevel) {
						case 0:
							updateText = '还差一单购物即可升级到V1会员';

							break;
						case 1:
						case 2:
						case 3:
							updateText = '还差' + curUserRemainBeauty + '美丽值升级到V' + curUserUpdateLevel + '会员';

							break;
						case 4:
							updateText = '恭喜你已成为尊贵的V4会员';
							break;
						default:
							break;
					}
				%>
				<div class="beauty">美丽值<%= curUserBeauty %><span class="desc"><%= updateText %></span></div>

				<div class="progress_wrap">
					<div class="level_text text_left">V<%= curUserLevel %></div>
					<div class="outer_progress_bar">
						<div class="inner_progress_bar" style="width:<%= curUserPercent %>">
							<div class="percent"><%= curUserPercent %></div>
						</div>
					</div>
					<div class="level_text text_right">V<%= curUserUpdateLevel %></div>
				</div>
			</div>
		</div>

		<div class="beauty_tips">如何提升美丽值&nbsp;<span class="mark"></span></div>
	</div>

	<div class="body_wrap">
		<div class="title_wrap">
			<div class="pro_title"><p>我的特权</p></div>
		</div>

		<div class="interest_wrap" id="interest_wrap">
			<ul class="interest_iscroll" id="interest_iscroll" style="width:990px;">
				<%
					var interestHtml = '';

					switch (curUserLevel) {
						case 0:
							interestHtml = [
								'<li class="active">',
									'<div class="member_interests interest_11" data-type="11"></div>',
									'<div class="text_title">签到领美美豆</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_1" data-type="1"></div>',
									'<div class="text_title">72小时发货</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_3" data-type="4"></div>',
									'<div class="text_title">新人专享活动</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_4" data-type="5"></div>',
									'<div class="text_title">7天无理由退货</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_5" data-type="6"></div>',
									'<div class="text_title">美美豆兑好券</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_6" data-type="3"></div>',
									'<div class="text_title">美美豆大转盘</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_8" data-type="9"></div>',
									'<div class="text_title">退货运费补贴</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_9" data-type="10"></div>',
									'<div class="text_title">先行赔付退款</div>',
								'</li>',
								'<li>',
									'<div class="member_interests interest_2" data-type="7"></div>',
									'<div class="text_title">白付美定向邀请</div>',
								'</li>',
								'<li>',
									'<div class="member_interests interest_7" data-type="2"></div>',
									'<div class="text_title">美美豆兑好礼</div>',
								'</li>',
								'<li>',
									'<div class="member_interests interest_10" data-type="8"></div>',
									'<div class="text_title">会员专属客服</div>',
								'</li>'
							].join('');

							break;
						case 1:
							interestHtml = [
								'<li class="active">',
									'<div class="member_interests interest_11" data-type="11"></div>',
									'<div class="text_title">签到领美美豆</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_1" data-type="1"></div>',
									'<div class="text_title">72小时发货</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_4" data-type="5"></div>',
									'<div class="text_title">7天无理由退货</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_5" data-type="6"></div>',
									'<div class="text_title">美美豆兑好券</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_6" data-type="3"></div>',
									'<div class="text_title">美美豆大转盘</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_8" data-type="9"></div>',
									'<div class="text_title">退货运费补贴</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_9" data-type="10"></div>',
									'<div class="text_title">先行赔付退款</div>',
								'</li>',
								'<li>',
									'<div class="member_interests interest_2" data-type="7"></div>',
									'<div class="text_title">白付美定向邀请</div>',
								'</li>',
								'<li>',
									'<div class="member_interests interest_3" data-type="4"></div>',
									'<div class="text_title">新人专享活动</div>',
								'</li>',
								'<li>',
									'<div class="member_interests interest_7" data-type="2"></div>',
									'<div class="text_title">美美豆兑好礼</div>',
								'</li>',
								'<li>',
									'<div class="member_interests interest_10" data-type="8"></div>',
									'<div class="text_title">会员专属客服</div>',
								'</li>'
							].join('');

							break;
						case 2:
							interestHtml = [
								'<li class="active">',
									'<div class="member_interests interest_11" data-type="11"></div>',
									'<div class="text_title">签到领美美豆</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_1" data-type="1"></div>',
									'<div class="text_title">72小时发货</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_4" data-type="5"></div>',
									'<div class="text_title">7天无理由退货</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_5" data-type="6"></div>',
									'<div class="text_title">美美豆兑好券</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_6" data-type="3"></div>',
									'<div class="text_title">美美豆大转盘</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_7" data-type="2"></div>',
									'<div class="text_title">美美豆兑好礼</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_8" data-type="9"></div>',
									'<div class="text_title">退货运费补贴</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_9" data-type="10"></div>',
									'<div class="text_title">先行赔付退款</div>',
								'</li>',
								'<li>',
									'<div class="member_interests interest_2" data-type="7"></div>',
									'<div class="text_title">白付美定向邀请</div>',
								'</li>',
								'<li>',
									'<div class="member_interests interest_3" data-type="4"></div>',
									'<div class="text_title">新人专享活动</div>',
								'</li>',
								'<li>',
									'<div class="member_interests interest_10" data-type="8"></div>',
									'<div class="text_title">会员专属客服</div>',
								'</li>'
							].join('');

							break;
						case 3:
							interestHtml = [
								'<li class="active">',
									'<div class="member_interests interest_11" data-type="11"></div>',
									'<div class="text_title">签到领美美豆</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_1" data-type="1"></div>',
									'<div class="text_title">72小时发货</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_4" data-type="5"></div>',
									'<div class="text_title">7天无理由退货</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_5" data-type="6"></div>',
									'<div class="text_title">美美豆兑好券</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_6" data-type="3"></div>',
									'<div class="text_title">美美豆大转盘</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_7" data-type="2"></div>',
									'<div class="text_title">美美豆兑好礼</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_8" data-type="9"></div>',
									'<div class="text_title">退货运费补贴</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_9" data-type="10"></div>',
									'<div class="text_title">先行赔付退款</div>',
								'</li>',
								'<li>',
									'<div class="member_interests interest_2" data-type="7"></div>',
									'<div class="text_title">白付美定向邀请</div>',
								'</li>',
								'<li>',
									'<div class="member_interests interest_3" data-type="4"></div>',
									'<div class="text_title">新人专享活动</div>',
								'</li>',
								'<li>',
									'<div class="member_interests interest_10" data-type="8"></div>',
									'<div class="text_title">会员专属客服</div>',
								'</li>'
							].join('');

							break;
						case 4:
							interestHtml = [
								'<li class="active">',
									'<div class="member_interests interest_11" data-type="11"></div>',
									'<div class="text_title">签到领美美豆</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_1" data-type="1"></div>',
									'<div class="text_title">72小时发货</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_2" data-type="7"></div>',
									'<div class="text_title">白付美定向邀请</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_4" data-type="5"></div>',
									'<div class="text_title">7天无理由退货</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_5" data-type="6"></div>',
									'<div class="text_title">美美豆兑好券</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_6" data-type="3"></div>',
									'<div class="text_title">美美豆大转盘</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_7" data-type="2"></div>',
									'<div class="text_title">美美豆兑好礼</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_8" data-type="9"></div>',
									'<div class="text_title">退货运费补贴</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_9" data-type="10"></div>',
									'<div class="text_title">先行赔付退款</div>',
								'</li>',
								'<li class="active">',
									'<div class="member_interests interest_10" data-type="8"></div>',
									'<div class="text_title">会员专属客服</div>',
								'</li>',
								'<li>',
									'<div class="member_interests interest_3" data-type="4"></div>',
									'<div class="text_title">新人专享活动</div>',
								'</li>'
							].join('');

							break;
						default:
							break;
					}
				%>

				<%= interestHtml %>
			</ul>
		</div>

		<div class="title_wrap beauty_title">
			<div class="pro_title"><p>会员与美丽值</p></div>
		</div>

		<div class="beauty_intro">
			<p>会员是指美丽说的注册用户。美丽说的会员有五个等级，分别为v0、v1、v2、v3、v4。</p>
			<p>美丽说的会员等级主要由美丽值决定，系统会根据您的美丽值自动更新您的会员等级。美丽值越高，会员等级就越高，享受的会员权益就越大。</p>
			<p>美丽值是美丽说会员的成长值，是衡量用户价值及活跃度的综合指标，可通过登录、购物、评价、晒单等操作获得美丽值。</p>
			<div class="more_hidden_content">
				<p>会员等级满足晋级条件系统会自动更新您的会员等级。每个等级的会员，自晋升之日起，即可享受相应的会员权益一周年，如果在此期间用户等级晋级，则以新的会员等级为起点计算相应的一周年权益时间。</p>
				<p>如果会员等级持续满一年未升级，V2 及以上等级的用户美丽值会有相应的折损，V0 和V1 等级的用户无需折损保级，永久有效。</p>
				<p>折损的规则如下：V2 折损200 美丽值，V3折损600 美丽值，V4折损2000 美丽值，系统会根据您的剩余美丽值重新计算会员等级。</p>
				<p>会员等级的保级计划开始时间为2016 年1月1 日。</p>
			</div>
			<div class="more_content_btn">展开<img src="http://d03.res.meilishuo.net/pic/_o/dc/62/834138f19d9b75805c34e851dea8_22_12.cf.png" alt=""></div>
		</div>

		<div class="title_wrap level_title">
			<div class="pro_title"><p>会员等级与权益</p></div>
		</div>

		<ul class="level_box">
			<%
				for (var k = 0; k < userMaxLevel; k++) {
					var levelClass = '';

					if (k == curUserLevel) {
						levelClass = 'level_' + k + ' active';
					} else {
						levelClass = 'level_' + k;
					}
			%>
			<li data-index="<%= k %>"><div class="<%= levelClass %>"></div></li>
			<%
				}
			%>
		</ul>

		<div class="level_swipe">
			<div id="j_level_swipe" class="swipe" data-type="level">
				<div class="swipe_wrap" style="width: 32000px;">
					<div class="swipe_pic">
						<div class="level_intro">
							<p class="title">达成条件：美丽说注册用户，且从未有过10元以上订单。</p>
							<p class="desc">会员权益：</p>
							<div class="content">
								<div>72h发货</div>
								<div>7天无理由退货</div>
								<div>退货运费补贴</div>
								<div>新人专享活动</div>
								<div>新手专区</div>
								<div>福利社</div>
								<div>大转盘抽奖</div>
								<div>签到领5美美豆</div>
								<div>美美豆换礼券</div>
							</div>
						</div>
					</div>

					<div class="swipe_pic">
						<div class="level_intro">
							<p class="title">达成条件：美丽值10~499之间，且单笔订单实际支付金额>10元。</p>
							<p class="desc">会员权益：</p>
							<div class="content">
								<div>72h发货</div>
								<div>7天无理由退货</div>
								<div>退货运费补贴</div>
								<div>福利社</div>
								<div>大转盘抽奖</div>
								<div>签到领10美美豆</div>
								<div>美美豆换礼券</div>
							</div>
						</div>
					</div>

					<div class="swipe_pic">
						<div class="level_intro">
							<p class="title">达成条件：美丽值500~1999之间，且单笔订单实际支付金额>10元。</p>
							<p class="desc">会员权益：</p>
							<div class="content">
								<div>72h发货</div>
								<div>7天无理由退货</div>
								<div>退货运费补贴</div>
								<div>福利社</div>
								<div>大转盘抽奖</div>
								<div>签到领15美美豆</div>
								<div>美美豆全额兑换优品</div>
								<div>美美豆换礼券</div>
							</div>
						</div>
					</div>

					<div class="swipe_pic">
						<div class="level_intro">
							<p class="title">达成条件：美丽值2000~5999之间，且单笔订单实际支付金额>10元。</p>
							<p class="desc">会员权益：</p>
							<div class="content">
								<div>72h发货</div>
								<div>7天无理由退货</div>
								<div>退货运费补贴</div>
								<div>福利社</div>
								<div>大转盘抽奖</div>
								<div>签到领20美美豆</div>
								<div>美美豆全额兑换优品</div>
								<div>美美豆换礼券</div>
							</div>
						</div>
					</div>

					<div class="swipe_pic">
						<div class="level_intro">
							<p class="title">达成条件：美丽值>=6000，且单笔订单实际支付金额>10元。</p>
							<p class="desc">会员权益：</p>
							<div class="content">
								<div>72h发货</div>
								<div>7天无理由退货</div>
								<div>退货运费补贴</div>
								<div>福利社</div>
								<div>大转盘抽奖</div>
								<div>签到领25美美豆</div>
								<div>美美豆全额兑换优品</div>
								<div>美美豆换礼券</div>
								<div>美丽说白付美定向邀请</div>
								<div>客服电话预约</div>
								<div>客服优先响应</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div class="gotop_wrap">
		<a class="gotop">
			<img src="http://d03.res.meilishuo.net/pic/_o/d0/68/f89d059f09d440f4ee7a37669383_80_80.cg.png" alt="">
		</a>
	</div>
</div>

<script type="text/html" id="j_layer_tpl">
	<div class="layer_shade j_layer_shade"></div>
	<div class="layer_main j_layer_main">
		<div class="m">
			<?
				var data = this.data || {},
					title = data.img_title || '',
					src = data.img_src || 'http://d03.res.meilishuo.net/pic/_o/ca/ee/3f0e33d1e9b3b7a5d6e50edf3110_500_698.cg.png';
			?>
			<img src="<?= src ?>" alt="<?= title ?>">
			<div class="know_btn"></div>
		</div>
	</div>
</script>

<script type="text/html" id="j_scroll_tpl">
	<div class="layer_shade j_layer_shade"></div>
	<div class="layer_main j_layer_main">
		<div class="m">
			<div class="layer_top"></div>
			<?
				var data = this.data || {},
					title = data.img_title || '',
					src = data.img_src || 'http://d03.res.meilishuo.net/pic/_o/ca/ee/3f0e33d1e9b3b7a5d6e50edf3110_500_698.cg.png';
			?>
			<div class="content">
				<img src="<?= src ?>" alt="<?= title ?>">
			</div>
			<div class="close_btn"></div>
		</div>
	</div>
</script>

<script>
	fml.vars.r = '<%= this.xr.r || '' %>';
	fml.vars.isLogin = <%= this.isLogin %>;
	fml.vars.isNewest = <%= this.isNewest %>;
	fml.vars.userLevel = <%= curUserLevel %>;
	fml.vars.pageData = <%= JSON.stringify(curPageData) %>;
</script>

<!-- <script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script> -->

<%! $_ENGINE_SELF.callFn("useModule")("<<<_use:
	fml.use('wap/page/member/interests');
_use:", this._JSstack, this._JSmods); %>

<%#foot_simple.html%>
